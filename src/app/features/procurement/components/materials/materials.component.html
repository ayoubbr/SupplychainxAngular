<div class="materials-container">
  <div class="page-header">
    <div class="header-content">
      <h1>Mati√®res Premi√®res</h1>
      <p>Inventaire et gestion des stocks</p>
    </div>
    <button class="btn btn-primary" (click)="createMaterial()">
      <span>+</span> Nouvelle Mati√®re
    </button>
  </div>

  <!-- Filters / Search -->
  <!--  <div class="filters-bar glass-panel">-->
  <!--    <div class="search-box">-->
  <!--      <span class="search-icon">üîç</span>-->
  <!--      <input type="text" placeholder="Rechercher une mati√®re..." class="search-input">-->
  <!--    </div>-->
  <!--    <div class="filter-actions">-->
  <!--      <button class="btn btn-secondary btn-icon">‚ö° Filtres</button>-->
  <!--      <button class="btn btn-secondary btn-icon">üì• Exporter</button>-->
  <!--    </div>-->
  <!--  </div>-->


  <div *ngIf="loading()">Loading...</div>
  <div *ngIf="error()" class="error">
    {{ error() }}
  </div>

  <!-- Data Table -->
  <div class="table-container glass-panel">
    <table class="data-table" *ngIf="!loading() && rawMaterials().length">
      <thead>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Stock Actuel</th>
        <th>Stock Min</th>
        <th>Unit√©</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let material of rawMaterials()">
        <td>{{ material.id }}</td>
        <td>{{ material.name }}</td>
        <td>{{ material.stock }}</td>
        <td>{{ material.minStock }}</td>
        <td>{{ material.unit }}</td>
        <td>
        <span class="status-badge " [class.warning]="material.stock < material.minStock"
              [class.success]="material.stock >= material.minStock">
          {{ material.stock < material.minStock ? 'CRITICAL' : 'OK' }}
        </span>
        </td>
        <td>
          <div class="action-buttons">
            <button class="btn-icon-small edit" title="Modifier"
                    (click)="editMaterial(material)">‚úèÔ∏è
            </button>
            <button class="btn-icon-small delete" title="Supprimer">üóëÔ∏è</button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>

    <div *ngIf="!loading() && !rawMaterials().length">
      No raw materials found
    </div>

  </div>
</div>

<!-- Form Overlay (Hidden by default, toggled by showForm) -->
<div class="form-overlay" *ngIf="showForm">
  <div class="form-card glass-panel" (click)="$event.stopPropagation()">
    <div class="form-header">
      <h2> {{ isEditMode ? 'Modifier Mati√®re Premi√®re' : 'Nouvelle Mati√®re Premi√®re' }}</h2>
      <button class="close-btn" (click)="showForm = false">‚úï</button>
    </div>

    <form class="glass-form" [formGroup]="materialForm">
      <div class="form-grid">
        <div class="form-group">
          <label>Nom de la mati√®re</label>
          <input type="text" formControlName="name" placeholder="Ex: Acier Inox 304">
        </div>

        <div class="form-group">
          <label>Unit√© de mesure</label>
          <select formControlName="unit">
            <option value="kg">Kilogramme (kg)</option>
            <option value="l">Litre (L)</option>
            <option value="pcs">Pi√®ce (Pcs)</option>
            <option value="m">M√®tre (m)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Stock Minimum (Alerte)</label>
          <input type="number" formControlName="minStock" placeholder="0">
        </div>

        <div class="form-group">
          <label>Stock Initial</label>
          <input type="number" formControlName="stock" placeholder="0">
        </div>

<!--        <div class="form-group full-width">-->
<!--          <label>Description / Notes</label>-->
<!--          <textarea rows="3" placeholder="D√©tails suppl√©mentaires..."></textarea>-->
<!--        </div>-->
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="showForm = false">Annuler</button>
        <button type="submit" class="btn btn-primary">Enregistrer</button>
      </div>
    </form>
  </div>
</div>
